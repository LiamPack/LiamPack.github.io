<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2019-07-27 Sat 15:04 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Compression and the ising model</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Liam Packer" />
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="preamble" class="status">
<script src="/skewer"></script>
<link type="text/css" href="css/base.css" rel="stylesheet">
<link type="text/css" href="css/skeleton.css" rel="stylesheet">
</div>
<div id="content">
<h1 class="title">Compression and the ising model</h1>

<div id="outline-container-org2b07163" class="outline-2">
<h2 id="org2b07163">some background if you need it</h2>
<div class="outline-text-2" id="text-org2b07163">
<p>
Recently as I was doing some reading<sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> on applying information
theory to detect phase transitions in non-equilibrium systems. What
does non-equilibrium mean? well I won't tell you, sorry. But what I
will tell you is that this stuff is really neat and easy to
apply. Information theory sounds really scary and I don't know much
about it, but what I do know about is some good old-fashioned
compression algorithms. (lossless) compression can be thought of as
the act of reducing the size of something while holding the same
"information". When looking at order-disorder phase transitions, you
may already see where we're heading.
</p>

<p>
As a fun way to learn a little bit of javascript, today I spent some
time looking at (the legendary) Schroeder's web-based physics
simulations you can find <a href="https://physics.weber.edu/schroeder/software/">at his website</a>. As you might have guessed
already (dang you're on a roll), I looked at <a href="https://physics.weber.edu/schroeder/software/demos/IsingModel.html">his ising model</a>.
</p>
</div>

<div id="outline-container-org1fa4216" class="outline-3">
<h3 id="org1fa4216"><span class="todo TODO">TODO</span> Information</h3>
<div class="outline-text-3" id="text-org1fa4216">
<p>
I guess we'll talk a little about information content first. If
you've taken a thermo or stat-mech class, you've probably
(hopefully (please god i hope you did)) see some mathematical
definition of entropy. It comes in a bunch of different looking
equivalent forms, but the one I'll give to you here is
</p>

<p>
\[ S(T) = -k_{B} \sum_{i} p_{i} \ln\, p_{i} \]
</p>

<p>
where p<sub>i</sub> is the probability of finding the system in state \(i\).
dang isn't that a good-looking equation. There's a lot of content
in why each part of the expression is chosen. Sometimes the entropy
is explained as how "disordered" a system is. This equation says
something more specific. If we choose a different base for the
logarithm (say, 2), then the sum is actually long-hand for
\(E[-\log\,p_{i}]\), the expectation value of the negative
log-probability. This gives us something to work with
conceptually. Since \(0 \leq p_{i} \leq 1\), in log base 2, this is giving us
the expected number of <span class="underline">bits</span> that we would need to encode the
frequencies of states for our system. So it's giving us a sort of
"best guess" on the amount of information needed to completely
describe our system in all of its glory. Or something like that,
I'm new to this too.
</p>

<p>
The Shannon entropy is exactly analagous:
</p>

<p>
\[H(X) = \sum_{i} p_{i} \log\, p_{i}\]
</p>

<p>
where \(X\) is some random variable I guess. The same analysis above
holds here, we're just not caring about units (more or less) or the second law of
thermodynamics anymore.
</p>
</div>

<div id="outline-container-orgeba3429" class="outline-4">
<h4 id="orgeba3429">What's the justification for the entropy here? where's my free energy and its derivatives? &gt;:(</h4>
<div class="outline-text-4" id="text-orgeba3429">
<p>
i'll explain this in the future probably just hold tight pls. 
</p>
</div>
</div>
</div>

<div id="outline-container-orgabf9bcb" class="outline-3">
<h3 id="orgabf9bcb"><span class="todo TODO">TODO</span> statmech game of life (better known as the ising model)</h3>
<div class="outline-text-3" id="text-orgabf9bcb">
<p>
Now what exactly is the <a href="https://en.wikipedia.org/wiki/Ising_model">ising model</a>? If you took CS31 at Swarthmore
College<sup>tm</sup> you'll note that some of the finite-sized simulations
look a bit like a game of life model, but more chaotic depending on
the temperature. Just like in GoL, there are two possible states
that a "cell" could be in. In the case of the ising mode lthe
states, or alphabet, are \(\mathcal{A} = \{-1, 1\}\). A state of size
N chosen from this alphabet we'll denote \(\mathcal{S}_{N} \equiv \{s^{1},
   \cdots, s^{N}\}\).  These represent the states "spin up" and "spin down",
representing the magnetic dipole moments of the atomic spins. As
for the dynamics, we get most of the picture just by looking at the
corresponding Hamiltonian function:
</p>

<p>
\[ H(\mathcal{S}_{N}) = -(J\sum_{i,N(i)}n^{i}n^{N(i)} + \mu\sum_{i}Bn_{i}).\]
</p>

<p>
Breaking this down, we can see that the first term represents the
interaction between two cells that are neighbors, and the second
term represents a uniform magnetic field imposed on the
system. Here I denoted the neighbors of cell \(i\) as
\(N(i)\). Couldn't think of any better notation, so we'll deal with
it for now.
</p>

<p>
Since we're really cool, we're going to drop the second term since
we don't care about a bias towards one spin or another (although
I'm more of a spin-up kinda guy myself, but I'll leave that for
another day). But then where do the dynamics come in? Well hold
your horses for pete's sake. The probability of a specific
configuration being chosen is given by the classic Boltzmann
distribution
</p>

<p>
<b>TODO</b> make this equation more readable
\[ P_{T}(\mathcal{S}) = \frac{e^{\frac{-H(\mathcal{S})}{k_B T}}}{Z_{T}} \]
</p>

<p>
So here we get to understand the dynamics a bit. We'll look at the
edge cases at \(T=1\) because I reserve the right to choose my
temperatures. If every cell is spin-up <span class="underline">or</span> spin-down, thenthe energy
simply \(-J\sum_{i,N(i)}1\). If we apply periodic boundary conditions and
every cell has four neighbors, then we get something like \(H =
   -4NJ\). Here, the corresponding probability of that low energy state
to occur is at a maximum. Then in the extreme where every neighbor
of a cell is the the opposing magnetization, \(H = 4NJ\) and its
corresponding probability is at a minimum. So by continuity or
something, the system will favor confiugrations that are at least
locally uniformly magnetized.
</p>

<p>
But as we vary \(T\), we would expect the system to be more
disordered as the probability distribution slowly smooths out. The
temperature acts as a balancing agent to the energy, where we may
expect things to become completely "disordered" past a certain
point. Or something like that. We still haven't talked about
simulating something like this.
</p>

<p>
So how would we simulate something like this? Well, being the
statistical mechanicians we are, we're going to look at a system of
magnetized atoms as being in a state of thermal equilibrium. Then,
given a system state \(\mathcal{S}\), we flip a <span class="underline">only one</span> atom from
one magnetic state to another. Well how do we choose this atom? We
put our computer scientist hat on and say "well, nothing Monte
Carlo simulations can't solve," which is a fancy way for saying
brute-force choose from a probability distribution. So we say,
given our state \(\mathcal{S}\) and a single atom flip resulting in
the state \(\mathcal{S}'\), we choose \(\mathcal{S}'\) with probability
given by \(P_{T}(S')\). At least that would be my guess.
</p>
</div>
</div>
</div>

<div id="outline-container-org6f48ba7" class="outline-2">
<h2 id="org6f48ba7">ok ok i get it but i do cs not physics</h2>
<div class="outline-text-2" id="text-org6f48ba7">
</div>
<div id="outline-container-orgd276706" class="outline-3">
<h3 id="orgd276706">grabbing some of those magnets</h3>
<div class="outline-text-3" id="text-orgd276706">
<p>
Okay with that over, we can talk about Schroeder's simulation. If
you do a little bit of snooping in the source, you'll find the
javascript <code>src</code> block that implements this simulation procedure. It's
pretty fast! As you may have read from the preface of the
simulation, he made this as a proof-of-concept, the concept being
that javascript driven web-simulations can be fast enough to be
useful as a pedagogical tool, rather than having to download some
<code>jar</code> file from PhET.
</p>

<p>
But we're going to one-up PhET and instead of downloading the
simulation, we'll just download every frame of the simulation. We're
brilliant!
</p>

<p>
First we need to take snap-shots of the images that the <code>&lt;canvas&gt;</code>
element is displaying on the web page. To do this, we can use the
function <code>toDataURL</code> given by the <code>canvas</code> element and have that hold
the image data. Then, we create a new hyperlink element <code>&lt;a&gt;</code> and
click on it. Wrap it up in a function and we have our guy. This will
prompt many, many (many) download requests, so don't forget to mark
"Remember this option" or whatever your computer calls it.
</p>

<div class="org-src-container">
<pre class="src src-javascript" id="orgc5dba75"><span style="color: #705B5F;">/* </span><span style="color: #705B5F;">Download a single img */</span>
<span style="color: #DC672C;">function</span> <span style="color: #56B5C2; font-weight: bold;">download</span>(<span style="color: #DF6B75;">T</span>,<span style="color: #DF6B75;">i</span>) {
    <span style="color: #DC672C;">var</span> <span style="color: #DF6B75;">link</span> = document.createElement(<span style="color: #E4BF7A;">"a"</span>);
    link.href = canvas.toDataURL(<span style="color: #E4BF7A;">"image/png"</span>);
    link.download =  <span style="color: #E4BF7A;">"T"</span>+ T.toString().replace(<span style="color: #E4BF7A;">/\./</span>g, <span style="color: #E4BF7A;">'p'</span>) + <span style="color: #E4BF7A;">"/"</span> + <span style="color: #E4BF7A;">"ising"</span> + i + <span style="color: #E4BF7A;">".png"</span>;
    link.style.display = <span style="color: #E4BF7A;">"none"</span>;
    <span style="color: #DC672C;">var</span> <span style="color: #DF6B75;">evt</span> = <span style="color: #DC672C;">new</span> <span style="color: #56B5C2;">MouseEvent</span>(<span style="color: #E4BF7A;">"click"</span>, {
        <span style="color: #E4BF7A;">"view"</span>: window,
        <span style="color: #E4BF7A;">"bubbles"</span>: <span style="color: #D19965;">true</span>,
        <span style="color: #E4BF7A;">"cancelable"</span>: <span style="color: #D19965;">true</span>
    });

    document.body.appendChild(link);
    link.dispatchEvent(evt);
    document.body.removeChild(link);
    console.log(<span style="color: #E4BF7A;">"Downloading..."</span>);
}
</pre>
</div>

<p>
Then, we download the <code>png</code> file image for this iteration step. Now,
I don't know about you, but my browser is going to be very upset
with the number of images being downloaded. So don't forget to check
the "remember for next time" box. For your own safety.
</p>

<div class="org-src-container">
<pre class="src src-javascript" id="orgdf9563c"><span style="color: #DC672C;">function</span> <span style="color: #56B5C2; font-weight: bold;">simulate</span>() {
    <span style="color: #DC672C;">if</span> (running) {
        <span style="color: #705B5F;">// </span><span style="color: #705B5F;">Execute a bunch of Monte Carlo steps:</span>

        ...
            download(T,i);
        ...
    }
}
</pre>
</div>

<p>
You can make some other modifications, such as randomizing the
temperature to be within a range (e.g. for [1.8,3] assign <code>T =
   1.8+Math.random()*1.2</code>). Don't forget to round if you want. I'm not
ur parent
</p>
</div>
</div>

<div id="outline-container-orgf3d003f" class="outline-3">
<h3 id="orgf3d003f">dealing with all the files</h3>
<div class="outline-text-3" id="text-orgf3d003f">
<p>
All the files downloaded were given a name in the format
<code>T$(temp)_ising$(i)</code>. Therefore all we need is to make a directory
with name <code>T$(temp)</code> and we'll be all sorted to make some graphs I
guess.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="orga855c8e"><span style="color: #56B5C2;">(</span><span style="color: #DC672C;">let</span> <span style="color: #EAEAFE;">(</span><span style="color: #DC672C;">(</span>dir <span style="color: #E4BF7A;">"~/sum19/ising/Temps/100x100/"</span><span style="color: #DC672C;">)</span><span style="color: #EAEAFE;">)</span>
  <span style="color: #EAEAFE;">(</span><span style="color: #DC672C;">dolist</span> <span style="color: #DC672C;">(</span>F <span style="color: #C7AE9D;">(</span>f-glob <span style="color: #E4BF7A;">"~/Downloads/T*ising*"</span><span style="color: #C7AE9D;">)</span><span style="color: #DC672C;">)</span>
    <span style="color: #DC672C;">(</span><span style="color: #DC672C;">let*</span> <span style="color: #C7AE9D;">(</span><span style="color: #DF6B75;">(</span>full-temp <span style="color: #D19965;">(</span>first <span style="color: #56B5C2;">(</span>last <span style="color: #EAEAFE;">(</span>split-string F <span style="color: #E4BF7A;">"/"</span><span style="color: #EAEAFE;">)</span><span style="color: #56B5C2;">)</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span>
           <span style="color: #DF6B75;">(</span>only-temp <span style="color: #D19965;">(</span>first <span style="color: #56B5C2;">(</span>split-string full-temp <span style="color: #E4BF7A;">"_"</span><span style="color: #56B5C2;">)</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span>
           <span style="color: #DF6B75;">(</span>temp-dir <span style="color: #D19965;">(</span>concat dir only-temp <span style="color: #E4BF7A;">"/"</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span><span style="color: #C7AE9D;">)</span>
      <span style="color: #C7AE9D;">(</span>mkdir temp-dir t<span style="color: #C7AE9D;">)</span>
      <span style="color: #C7AE9D;">(</span>rename-file F temp-dir<span style="color: #C7AE9D;">)</span><span style="color: #DC672C;">)</span><span style="color: #EAEAFE;">)</span><span style="color: #56B5C2;">)</span>

</pre>
</div>

<p>
Then we get the file size of each <code>png</code> file and average over the
temperature. In the process, we also output an <code>org</code> table that we
can easily feed into <code>gnuplot</code>. It's not the best Elisp I've written,
but it gets the job done.
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp" id="org46b9f58"><span style="color: #56B5C2;">(</span><span style="color: #DC672C;">defun</span> <span style="color: #56B5C2; font-weight: bold;">traverse-temperatures</span> <span style="color: #EAEAFE;">(</span>temp-list output<span style="color: #EAEAFE;">)</span>
  <span style="color: #705B5F;">;; </span><span style="color: #705B5F;">Traverse through the temperature directories to find out the</span>
  <span style="color: #705B5F;">;; </span><span style="color: #705B5F;">average file size obtained.</span>
  <span style="color: #EAEAFE;">(</span><span style="color: #DC672C;">if</span> <span style="color: #DC672C;">(</span>= <span style="color: #C7AE9D;">(</span>length temp-list<span style="color: #C7AE9D;">)</span> 0<span style="color: #DC672C;">)</span>
      output
      <span style="color: #DC672C;">(</span><span style="color: #DC672C;">let*</span> <span style="color: #C7AE9D;">(</span><span style="color: #DF6B75;">(</span>dirname <span style="color: #D19965;">(</span>car temp-list<span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span>
             <span style="color: #DF6B75;">(</span>temp-string <span style="color: #D19965;">(</span>first <span style="color: #56B5C2;">(</span>last <span style="color: #EAEAFE;">(</span>split-string dirname <span style="color: #E4BF7A;">"/"</span><span style="color: #EAEAFE;">)</span><span style="color: #56B5C2;">)</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span>
             <span style="color: #DF6B75;">(</span>temp-value <span style="color: #D19965;">(</span>substring temp-string 1 <span style="color: #56B5C2;">(</span>length temp-string<span style="color: #56B5C2;">)</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span>
             <span style="color: #DF6B75;">(</span>filesizes <span style="color: #D19965;">(</span>mapcar #'<span style="color: #56B5C2;">(</span>lambda<span style="color: #EAEAFE;">(</span>x<span style="color: #EAEAFE;">)</span>
                                    <span style="color: #EAEAFE;">(</span>file-attribute-size <span style="color: #DC672C;">(</span>file-attributes x<span style="color: #DC672C;">)</span><span style="color: #EAEAFE;">)</span><span style="color: #56B5C2;">)</span>
                                <span style="color: #56B5C2;">(</span>directory-files dirname t <span style="color: #E4BF7A;">".*png"</span><span style="color: #56B5C2;">)</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span><span style="color: #C7AE9D;">)</span>
        <span style="color: #C7AE9D;">(</span>traverse-temperatures <span style="color: #DF6B75;">(</span>cdr temp-list<span style="color: #DF6B75;">)</span>
                               <span style="color: #DF6B75;">(</span>concat output
                                       <span style="color: #D19965;">(</span>format <span style="color: #E4BF7A;">"|%s |%d|\n"</span>
                                               <span style="color: #56B5C2;">(</span>replace-regexp-in-string <span style="color: #E4BF7A;">"p"</span> <span style="color: #E4BF7A;">"."</span> temp-value<span style="color: #56B5C2;">)</span>
                                               <span style="color: #56B5C2;">(</span>/ <span style="color: #EAEAFE;">(</span>reduce #'+ filesizes<span style="color: #EAEAFE;">)</span> <span style="color: #EAEAFE;">(</span>length filesizes<span style="color: #EAEAFE;">)</span><span style="color: #56B5C2;">)</span><span style="color: #D19965;">)</span><span style="color: #DF6B75;">)</span><span style="color: #C7AE9D;">)</span><span style="color: #DC672C;">)</span><span style="color: #EAEAFE;">)</span><span style="color: #56B5C2;">)</span>

<span style="color: #56B5C2;">(</span>traverse-temperatures <span style="color: #EAEAFE;">(</span>directory-files <span style="color: #E4BF7A;">"~/sum19/ising/Temps/uniform_init"</span> t <span style="color: #E4BF7A;">"T.*"</span><span style="color: #EAEAFE;">)</span>
                       <span style="color: #E4BF7A;">"#+TBLNAME: TvsS\n|T | filesize|\n|------+-----|\n"</span><span style="color: #56B5C2;">)</span>

</pre>
</div>

<p>
Now all we have to do is plot the data that we grabbed from system
statistics. To do this, we feed the above table into the amazing
<code>gnuplot</code> and make a simple graph of points in a region of interest
(T∈[0,5]). 
</p>

<p>
Maybe a second to talk about what we're going to expect here. At
low temperatures, file size will be smallest since the system will
stay roughly uniform. As we increase the temperature, there will be
a corresponding increase in the background noise of other
spins. Close to the critical point, we would expect islands and
blobs to start forming. After the critical point, things will
become very noisy and there will be some upper-bound on the
compressed file-size, corresponding to a maximally "random"
configuration. Then qualitatively, we may expect the critical point
to be the inflection point of information content. Who knows.
</p>

<div class="org-src-container">
<pre class="src src-gnuplot" id="org1c78ac4"><span style="color: #D19965;">set</span> <span style="color: #56B5C2;">title</span> <span style="color: #E4BF7A;">"Temperature vs. filesize of 2D Ising Model (100x100)"</span>
<span style="color: #D19965;">set</span> xlabel <span style="color: #E4BF7A;">"T"</span>
<span style="color: #D19965;">set</span> ylabel <span style="color: #E4BF7A;">"Average Compressed File size (KB)"</span>
<span style="color: #D19965;">set</span> xrange [<span style="color: #D19965;">0:5</span>]

<span style="color: #DC672C;">plot</span> data u 1:2 <span style="color: #56B5C2;">with</span> <span style="color: #56B5C2; font-weight: bold;">points</span>
</pre>
</div>


<div class="figure">
<p><img src="TvsS.png" alt="TvsS.png" />
</p>
</div>

<p>
So that's cool, we can probe the critical points of some order
parameter by looking at the changes in entropy between different
values of that order parameter. We can probably do even better. But
I'm lazy.
</p>
</div>
</div>
</div>

<div id="outline-container-orgadefaa6" class="outline-2">
<h2 id="orgadefaa6">FAQs that haven't been asked yet</h2>
<div class="outline-text-2" id="text-orgadefaa6">
</div>
<div id="outline-container-org1f7542f" class="outline-3">
<h3 id="org1f7542f">why do this when u already have an analytic expression for entropy</h3>
<div class="outline-text-3" id="text-org1f7542f">
<p>
well first of all its cool and that's all the explanation i need.
</p>

<p>
But other than that, this is more of a proof-of-the-concept that
more complicated systems with more subtle order-disorder phase
transitions could possibly be probed by the information content of
the system. Even for non-equilibrium systems! Amazing! (See <sup><a id="fnr.1.100" class="footref" href="#fn.1">1</a></sup>)
</p>
</div>
</div>

<div id="outline-container-org895989d" class="outline-3">
<h3 id="org895989d">why lisp</h3>
<div class="outline-text-3" id="text-org895989d">
<p>
i reserve the right to withhold a response to this.
</p>
</div>
</div>
</div>
<div id="footnotes">
<h2 class="footnotes">Footnotes: </h2>
<div id="text-footnotes">

<div class="footdef"><sup><a id="fn.1" class="footnum" href="#fnr.1">1</a></sup> <div class="footpara"><p class="footpara">
An amazing paper by Dov Levine and his group on the usage of
information entropy to detect order-disorder phase transitions: <a href="https://journals.aps.org/prx/abstract/10.1103/PhysRevX.9.011031">https://journals.aps.org/prx/abstract/10.1103/PhysRevX.9.011031</a>
</p></div></div>


</div>
</div></div>
</body>
</html>